#!/bin/bash

case $# in
   0)
      echo "Usage: $0 {start|stop}"
      exit 1
      ;;
   1)
      case $1 in
         start)
            echo "Starting GlobalProtect..."
            launchctl load /Library/LaunchAgents/com.paloaltonetworks.gp.pangpa.plist
            launchctl load /Library/LaunchAgents/com.paloaltonetworks.gp.pangps.plist
            launchctl start com.paloaltonetworks.gp.pangpa
            echo "Done!"
            ;;
         stop)
            echo "Stopping GlobalProtect..."
            launchctl remove com.paloaltonetworks.gp.pangps
            launchctl remove com.paloaltonetworks.gp.pangpa
            scselect Automatic
            echo "Done!"
            ;;
        dns)
          pid=$(scutil <<EOF | grep PrimaryService | sed -e 's/.*PrimaryService : //'
open
get State:/Network/Global/IPv4
d.show
quit
EOF
)
          sudo scutil <<EOF
open
d.init
d.add ServerAddresses * 10.207.15.201
d.add DomainName int.vertivco.com
set State:/Network/Service/$pid/DNS
quit
EOF
          ;;
         *)
            echo "'$1' is not a valid verb."
            echo "Usage: $0 {start|stop}"
            exit 2
            ;;
      esac
      ;;
   *)
      echo "Too many args provided ($#)."
      echo "Usage: $0 {start|stop}"
      exit 3
      ;;
esac
